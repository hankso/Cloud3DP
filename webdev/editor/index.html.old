<!doctype html><html lang=en><title>Online Editor</title><meta http-equiv=content-type content="text/html; charset=utf-8"><style>.hidden{display:none}.custom-sb::-webkit-scrollbar{height:3px;width:3px;background-color:transparent}.custom-sb::-webkit-scrollbar-thumb{background-color:#aaa}a{cursor:pointer}svg{height:16px;width:16px}#preview img{display:block;max-width:100%;max-height:100%;margin:auto}html{font-size:16px;font-family:Ubuntu,Tahoma,monospace}body{display:flex;flex-flow:row wrap;position:absolute;left:0;right:0;top:0;bottom:0;margin:0;text-align:left}body>div{height:calc(100% - 1.5rem);border:1px solid gray;box-sizing:border-box}#tree{flex:2;overflow:auto}#tree #parent-list{color:green}#tree #parent-list:hover{color:gray}#tree #parent-list a:hover{color:green;font-weight:700}#tree #leaf-list{list-style:none;padding-top:1em}#tree #leaf-list>*{padding-left:1em}#tree .path{white-space:nowrap}#tree .path.dir{color:#00f}#tree .highlightEdit{background-color:#d3d3d3;color:red}#editor,#preview{flex:8;overflow-x:auto}#bottombar{flex:100%;position:relative;height:1.5em;padding-right:5em}#bottombar>div{height:100%}#bottombar #status-box{overflow-y:hidden;font-size:.8rem;line-height:calc(1.5rem - 2px)}#bottombar #status-box .message{padding-left:.5rem}#bottombar #status-box .progbar{text-align:center}#bottombar #status-box .progbar *{background-color:#90ee90}#bottombar #menu-box{position:absolute;top:0;right:0;width:5rem;border-left:1px solid gray;padding-top:1px;display:flex;flex-wrap:nowrap;align-items:center;justify-content:space-evenly}#bottombar #menu-box #menu-panel{position:absolute;right:0;bottom:1.5rem;width:15em;border:1px solid #00f;border-radius:1em;border-bottom-right-radius:0;padding:1em;z-index:999;background-color:#c3c3c380}#menu-panel>div{transition:all .3s;width:100%;height:1.8rem;overflow:hidden;display:flex;flex-flow:nowrap;align-items:center;justify-content:space-between}#menu-panel input[type=text]{max-width:60%}#menu-panel label{font-size:.8rem;font-family:monospace}#menu-panel[data-type]{display:block}#menu-panel[data-type=create] .for-upload,#menu-panel[data-type=upload] .for-create{height:0}</style><script>function ajaxXHR(e,t,o={}){e instanceof Object&&(e=(o=e).url),t instanceof Function?o.success=o.success||t:t instanceof Object&&(o=t);let s=new XMLHttpRequest;if(s.withCredentials=Boolean(o.crossorigin)||!1,s.onerror=()=>console.error("Network error"),s.onprogress=o.progress||function(e){e.lengthComputable?console.log(`Received ${e.loaded} of ${e.total} bytes`):console.log("Received "+formatSize(e.loaded))},s.onload=function(){200!=s.status?o.error?o.error(s,s.status,s.statusText):console.error(`Error ${s.status}: ${s.statusText}`):(o.success||console.log)(s.response,s.status,s)},s.responseType=o.dataType||"",s.open(o.method||"GET",e,o.async||!0),o.data){var r;if(o.data instanceof FormData)r=o.data;else if(o.data instanceof Object){r=new FormData;for(let e in o.data)r.append(e,o.data[e])}else{if(!(o.data instanceof String))throw Error("Invalid XMLHttpRequest parameter",o.data);s.setRequestHeader("Content-Type","application/json"),r=o.data}s.send(r)}else s.send()}"undefined"==typeof XMLHttpRequest&&(XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")});</script><script>var API=function(){var apilist={get:"/edit",list:"/edit?list=${path}",edit:"/edit?path=${path}",down:"/edit?path=${path}&download",create:"/editc?path=${path}&type=${arg}",delete:"/editd?path=${path}",upload:"/editu?overwrite"};return(method,path,arg)=>!method in apilist?(console.error(`Invalid API name: "${method}"`),""):eval("`"+apilist[method]+"`")}();function ge(e){return document.getElementById(e)}function ce(e){return document.createElement(e)}function downloadFile(e,t){ajaxXHR({url:API("down",e),method:"GET",success:t})}function listDir(e,t,o){ajaxXHR({url:API("list",e),method:"GET",dataType:"json",success:t,error:o})}function createPath(e,t,o){ajaxXHR({url:API("create",e,t?"dir":"file"),method:"GET",success:o||function(t,o){console.log(`"${e}" successfully created!`),window.location.reload()},error:(t,o,a)=>alert(`Cannot create "${e}": ${a}!`)})}function deletePath(e,t){confirm(`Delete path "${e}"?`)&&ajaxXHR({url:API("delete",e),method:"GET",success:t||function(t,o){console.log(`"${e}" successfully deleted!`),window.location.reload()},error:(t,o,a)=>alert(`Cannot delete "${e}": ${a}!`)})}var formatSize=function(){var e=["B","K","M","G","T","P"],t=[0,1,2,3,3,3];return function(o,a=1024){let n=Math.log2(o)/Math.log2(a);return n=Math.min(Math.floor(n),e.length-1),(o/a**n).toFixed(t[n])+e[n]}}();</script><script src=../node_modules/ace-builds/src/ace.js></script><script src=../node_modules/ace-builds/src/ext-keybinding_menu.js></script><script src=../node_modules/ace-builds/src/ext-settings_menu.js></script><body onload=onBodyLoad()><div id=tree class=custom-sb><div>Index <span id=parent-list></span></div><div id=leaf-list></div></div><div id=editor class=custom-sb></div><div id=preview class=hidden><img></div><div id=bottombar><div id=status-box><div class=progbar><div></div></div><div class=message></div></div><div id=menu-box><a class="icon toggle" title="Tree View" onclick=treeToggle()></a> <a class="icon refresh" title=Refresh onclick=treeRefresh()></a> <a class="icon upload" onclick='menuToggle("upload")'></a> <a class="icon create" onclick='menuToggle("create")'></a><form id=menu-panel class=hidden><div class=for-upload><input id=upload-file type=file onchange=uploadName()></div><div><label>Path name</label> <input id=upload-path name=path value=/ ></div><div class=for-create><label>Path type</label> <select id=upload-type><option value=file selected>file<option value=folder>folder</select> <button onclick="return createFile()">Create</button></div><div><button onclick="return uploadFile()">Upload</button> <input type=reset value=Reset></div></form></div></div><script>function createEditor(e){let i=ace.edit(e,{theme:"ace/theme/"+(config.theme||"textmate"),highlightActiveLine:!0,showFoldWidgets:!0,showPrintMargin:!1});return ace.require("ace/ext/settings_menu").init(i),ace.require("ace/ext/keybinding_menu").init(i),i.on("change",()=>{config.modified=!0}),i.session.setUseSoftTabs(!0),i.session.setTabSize(4),i.setHighlightActiveLine(!0),i.setShowFoldWidgets(!0),i.setShowPrintMargin(!1),i.commands.addCommands([{name:"save",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:updateFile,readOnly:!1},{name:"settings",bindKey:{win:"Ctrl-Q",mac:"Command-Q"},exec:e=>e.showSettingsMenu(),readOnly:!1},{name:"keybings",bindKey:{win:"Ctrl-H",mac:"Command-H"},exec:e=>e.showKeyboardShortcuts()}]),i}ace.Editor.prototype.loadFile=function(e,i){e&&e!=config.filename?("true"==config.modified&&(logStatus("auto-saving..."),editor.execCommand("save")),config.modified=!1):e=e||config.filename;let n=config.pathname;if(e.includes("/"))if(e.endsWith("/"))n=config.filename,e="index.html";else{let i=e.lastIndexOf("/");n=e.substr(0,i+1)}else{if(!n)throw Error("Invalid filename to edit: "+e);e=n+e}if(config.filename=e,config.pathname=n,treeRefresh(),"img"==getTypeFromFilename(e))return this.container.style.display="none",ge("preview").style.display="block",void(ge("preview").children[0].src=API("edit",e));this.container.style.display="block",ge("preview").style.display="none",config.lang=i=i||getLangFromFilename(e),"plain"!=i&&this.session.setMode("ace/mode/"+i);let t=this;ajaxXHR({url:API("edit",e),method:"GET",success:i=>{t.setValue(i),t.clearSelection(),logStatus(`Editing "${e}"`),config.modified=!1},error:()=>t.setValue("File cannot be loaded!"),progress:ajaxProgress})};</script><script>function treeToggle(){let e=ge("tree").style;"none"===e.display?(e.display="block",logStatus("Tree view enabled")):(e.display="none",logStatus("Tree view disabled"))}function treeRefresh(){if("none"===ge("tree").style.display)return;let lst=ge("leaf-list"),tpl=ge("template-leaf"),prt=ge("parent-list"),root=config.pathname,parents=root.substr(0,root.length-1).split("/");prt.innerHTML="";for(let e,t=0;t<parents.length;t++)e=ce("a"),e.innerText=parents[t]+"/",e.dataset.path=parents.slice(0,t+1).join("/")+"/",e.onclick=function(){treeSwitch(this.dataset.path)},prt.appendChild(e);listDir(root,filelist=>{filelist.sort((e,t)=>{let n=e.name,i=t.name;return n<i?-1:n>i?1:0}),lst.innerHTML="",filelist.forEach(({name:name,type:type,size:size})=>{if(name.startsWith("."))return;let isdir="file"!=type,iscur=root+name==config.filename;lst.innerHTML+=eval("`"+tpl.innerHTML+"`")}),logStatus("Tree view rendered")})}function treeSwitch(e){e.startsWith("/")?(e.endsWith("/")||(e+="/"),config.pathname=e):config.pathname+=e+"/",treeRefresh()}</script><script>function menuToggle(e){let a=ge("menu-panel").dataset;a.type&&a.type===e?delete a.type:(a.type=e,ge("upload-path").value=config.pathname)}function createFile(){let e=ge("upload-path");if(!e.value||"/"==e.value)return logStatus("Invalid path name"),!1;let a="folder"==ge("upload-type").selectedOptions[0].value;return createPath(e.value,a,treeRefresh),e.value=config.pathname,!0}function uploadName(){let e=ge("upload-file");e.files.length&&(ge("upload-path").value+=e.files[0].name)}function uploadFile(){let e=ge("upload-file");if(!e.files.length)return logStatus("No file selected"),!1;let a=ge("upload-path"),t=a.value;t.startsWith("/")||(t="/"+t);let l=new FormData;return l.append("data",e.files[0],t),ajaxXHR(API("upload"),{method:"POST",data:l,success:()=>{logStatus(`"${t}" uploaded`),treeRefresh()},error:(e,a,t)=>{logStatus(`Upload failed [${a}]: ${t}`)},progress:ajaxProgress}),a.value=config.pathname,e.value="",!0}function updateFile(){if(void 0===this.semaphore&&(this.semaphore=0),this.semaphore)return logStatus("Busy updating file");this.semaphore=1;let e=editor.getValue()+"",a=new Blob([e],{type:"text/plain"}),t=new FormData;t.append("data",a,config.filename),ajaxXHR(API("upload"),{method:"POST",data:t,success:()=>{logStatus(`"${config.filename}" saved`),config.modified=!1,updateFile.semaphore=0},error:(e,a,t)=>{logStatus(`Save failed [${a}]: ${t}`),updateFile.semaphore=0},progress:ajaxProgress})}</script><script>function getLangFromFilename(e){let t="plain",a=e.split(".");if(a.length<2)return t;switch(a[1]){case"ts":t="typescript";break;case"js":t="javascript";break;case"txt":case"hex":t="plain";break;case"conf":case"ini":t="ini";break;case"htm":case"html":t="html";break;case"md":case"markdown":t="markdown";break;case"h":case"c":case"cpp":t="c_cpp";break;case"css":case"svg":case"scss":case"gcode":case"json":case"xml":t=a[1]}return t}function getTypeFromFilename(e){switch(e.split(".")[1]){case"png":case"jpg":case"gif":case"ico":case"bmp":return"img";default:return"text"}}var ajaxProgress=function(){var e=ge("status-box"),t=(e.children[1],e.children[0]),a=t.children[0],s=!1;function c(){s&&(s=!1,t.style.display="none")}return e=>{e.lengthComputable?(s||(s=!0,t.style.display="block"),function(e=0){a.style.width=a.innerText=e+"%"}((e.loaded/e.total*100).toFixed(1))):(c(),logStatus("Received "+formatSize(e.loaded))),e.loaded==e.total&&setTimeout(c,500)}}();function logStatus(e){let t=(new Date).toLocaleTimeString(),a=ge("status-box").children[1];a.innerHTML=`${t} - ${e}`,console.log(e),clearTimeout(this.id||0),this.id=setTimeout((function(){a.innerHTML=""}),5e3)}</script><script>// recover from where you left last time
        window.config = localStorage;
        function onBodyLoad() {
            // specify filename/language-highlight etc. via URL
            let search = new URLSearchParams(window.location.search);
            for (let [k, v] of search) config.setItem(k, v);
            config.filename = config.filename || "/index.html";
            window.editor = createEditor("editor");
            editor.loadFile(config.filename, config.lang);
            // hide files tree when the editor page is imported as iframe
            if (config.tree === "hide") {
                ge("tree").style.display = "none";
                treeToggle = ()=>{};
            }
        }</script><script type=text/template , id=template-leaf><li id="${name}" class="${iscur ? 'highlightEdit' : ''}"
         ${name.endsWith('.gz') ? 'disabled' : ''}>
            <a class="path ${type}"
             onclick="${isdir ? `treeSwitch('${name}')` : `editor.loadFile('${config.pathname}${name}')`}">
                ${name + (isdir ? "/" : "")}
            </a>
            <span class="hidden">
                <a class="icon trash" onclick="deletePath('${name}')"></a>
                <a class="icon download ${isdir ? 'hidden' : ''}"
                 href="${API('down', name)}" target="_blank"></a>
            </span>
        </li></script>